/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool";
import { ElevenLabsClient } from "../../src/Client";
import * as ElevenLabs from "../../src/api/index";

describe("PronunciationDictionaries", () => {
    test("create_from_rules (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            rules: [{ type: "alias", string_to_replace: "Thailand", alias: "tie-land" }],
            name: "My Dictionary",
        };
        const rawResponseBody = {
            id: "5xM3yVvZQKV0EfqQpLrJ",
            name: "My Dictionary",
            created_by: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creation_time_unix: 1714156800,
            version_id: "5xM3yVvZQKV0EfqQpLrJ",
            version_rules_num: 5,
            description: "This is a test dictionary",
            permission_on_resource: "admin",
        };
        server
            .mockEndpoint()
            .post("/v1/pronunciation-dictionaries/add-from-rules")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.createFromRules({
            rules: [
                {
                    type: "alias",
                    stringToReplace: "Thailand",
                    alias: "tie-land",
                },
            ],
            name: "My Dictionary",
        });
        expect(response).toEqual({
            id: "5xM3yVvZQKV0EfqQpLrJ",
            name: "My Dictionary",
            createdBy: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creationTimeUnix: 1714156800,
            versionId: "5xM3yVvZQKV0EfqQpLrJ",
            versionRulesNum: 5,
            description: "This is a test dictionary",
            permissionOnResource: "admin",
        });
    });

    test("create_from_rules (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            rules: [
                { type: "alias", string_to_replace: "string_to_replace", alias: "alias" },
                { type: "alias", string_to_replace: "string_to_replace", alias: "alias" },
            ],
            name: "name",
            description: undefined,
            workspace_access: undefined,
        };
        const rawResponseBody = { detail: undefined };
        server
            .mockEndpoint()
            .post("/v1/pronunciation-dictionaries/add-from-rules")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pronunciationDictionaries.createFromRules({
                rules: [
                    {
                        type: "alias",
                        stringToReplace: "string_to_replace",
                        alias: "alias",
                    },
                    {
                        type: "alias",
                        stringToReplace: "string_to_replace",
                        alias: "alias",
                    },
                ],
                name: "name",
                description: undefined,
                workspaceAccess: undefined,
            });
        }).rejects.toThrow(ElevenLabs.UnprocessableEntityError);
    });

    test("get (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "5xM3yVvZQKV0EfqQpLrJ",
            latest_version_id: "5xM3yVvZQKV0EfqQpLr2",
            latest_version_rules_num: 2,
            name: "My Dictionary",
            permission_on_resource: "admin",
            created_by: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creation_time_unix: 1714156800,
            archived_time_unix: 1,
            description: "This is a test dictionary",
        };
        server
            .mockEndpoint()
            .get("/v1/pronunciation-dictionaries/21m00Tcm4TlvDq8ikWAM")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.get("21m00Tcm4TlvDq8ikWAM");
        expect(response).toEqual({
            id: "5xM3yVvZQKV0EfqQpLrJ",
            latestVersionId: "5xM3yVvZQKV0EfqQpLr2",
            latestVersionRulesNum: 2,
            name: "My Dictionary",
            permissionOnResource: "admin",
            createdBy: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creationTimeUnix: 1714156800,
            archivedTimeUnix: 1,
            description: "This is a test dictionary",
        });
    });

    test("get (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: undefined };
        server
            .mockEndpoint()
            .get("/v1/pronunciation-dictionaries/pronunciation_dictionary_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pronunciationDictionaries.get("pronunciation_dictionary_id");
        }).rejects.toThrow(ElevenLabs.UnprocessableEntityError);
    });

    test("update (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            id: "5xM3yVvZQKV0EfqQpLrJ",
            latest_version_id: "5xM3yVvZQKV0EfqQpLr2",
            latest_version_rules_num: 2,
            name: "My Dictionary",
            permission_on_resource: "admin",
            created_by: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creation_time_unix: 1714156800,
            archived_time_unix: 1,
            description: "This is a test dictionary",
        };
        server
            .mockEndpoint()
            .patch("/v1/pronunciation-dictionaries/21m00Tcm4TlvDq8ikWAM")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.update("21m00Tcm4TlvDq8ikWAM");
        expect(response).toEqual({
            id: "5xM3yVvZQKV0EfqQpLrJ",
            latestVersionId: "5xM3yVvZQKV0EfqQpLr2",
            latestVersionRulesNum: 2,
            name: "My Dictionary",
            permissionOnResource: "admin",
            createdBy: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
            creationTimeUnix: 1714156800,
            archivedTimeUnix: 1,
            description: "This is a test dictionary",
        });
    });

    test("update (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { archived: undefined, name: undefined };
        const rawResponseBody = { detail: undefined };
        server
            .mockEndpoint()
            .patch("/v1/pronunciation-dictionaries/pronunciation_dictionary_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pronunciationDictionaries.update("pronunciation_dictionary_id", {
                archived: undefined,
                name: undefined,
            });
        }).rejects.toThrow(ElevenLabs.UnprocessableEntityError);
    });

    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            pronunciation_dictionaries: [
                {
                    id: "5xM3yVvZQKV0EfqQpLrJ",
                    latest_version_id: "5xM3yVvZQKV0EfqQpLr2",
                    latest_version_rules_num: 2,
                    name: "My Dictionary",
                    permission_on_resource: "admin",
                    created_by: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
                    creation_time_unix: 1714156800,
                    archived_time_unix: 1,
                    description: "This is a test dictionary",
                },
            ],
            next_cursor: "5xM3yVvZQKV0EfqQpLr2",
            has_more: false,
        };
        server
            .mockEndpoint()
            .get("/v1/pronunciation-dictionaries")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.list({
            cursor: "cursor",
            pageSize: 1,
            sort: "creation_time_unix",
            sortDirection: "sort_direction",
        });
        expect(response).toEqual({
            pronunciationDictionaries: [
                {
                    id: "5xM3yVvZQKV0EfqQpLrJ",
                    latestVersionId: "5xM3yVvZQKV0EfqQpLr2",
                    latestVersionRulesNum: 2,
                    name: "My Dictionary",
                    permissionOnResource: "admin",
                    createdBy: "ar6633Es2kUjFXBdR1iVc9ztsXl1",
                    creationTimeUnix: 1714156800,
                    archivedTimeUnix: 1,
                    description: "This is a test dictionary",
                },
            ],
            nextCursor: "5xM3yVvZQKV0EfqQpLr2",
            hasMore: false,
        });
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: undefined };
        server
            .mockEndpoint()
            .get("/v1/pronunciation-dictionaries")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pronunciationDictionaries.list();
        }).rejects.toThrow(ElevenLabs.UnprocessableEntityError);
    });
});
